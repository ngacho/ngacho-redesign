/*! For license information please see miscFilesListAdmin.js.LICENSE.txt */
(()=>{"use strict";var e={"./app/controller/misc-file-list-controller.js":(e,t,s)=>{s.r(t),s.d(t,{MiscFileListController:()=>l});class l{constructor(e,t){this.view=e,this.model=t,this.init()}init(){this.fetchMiscFiles(),this.view.bindCopyFileUrl(this.handleGetFileById),this.view.bindDeleteFile(this.handleDeleteFile)}fetchMiscFiles(){this.model.getMiscFilesFromDb().then((e=>{this.view.renderMiscFiles(e)})).catch((e=>console.log(e)))}handleGetFileById=async e=>this.model.getMiscFilesFromDbById(e);handleDeleteFile=async e=>this.model.deleteMiscFileFromDb(e)}},"./app/model/base-models/base-model.js":(e,t,s)=>{s.r(t),s.d(t,{BaseModel:()=>l});class l{constructor(e){this.baseUrl=e}async getList(){return new Promise(((e,t)=>{fetch(this.baseUrl,{credentials:"include"}).then((s=>{Promise.all([s.json(),s.status]).then((([s,l])=>{200===l?e(s):(console.log(err),t(`Failed with response ${l}`))})).catch((e=>{console.log(e),t(`Failed response: ${e}`)}))})).catch((e=>{console.log(e),t("Failed to fetch")}))}))}async getListByTag(e){return new Promise(((t,s)=>{fetch(`${this.baseUrl}/tags/${encodeURIComponent(e)}`).then((e=>{Promise.all([e.json(),e.status]).then((([e,l])=>{200===l?t(e):s(`Failed with response ${l}`)})).catch((e=>{s(`Failed response: ${e}`)}))})).catch((e=>s("Failed to fetch")))}))}async getListItemById(e,t){return new Promise(((s,l)=>{fetch(`${this.baseUrl}/${e}/${t}`,{credentials:"include"}).then((e=>{Promise.all([e.json(),e.status]).then((([e,t])=>{200===t?s(e):l(`Failed with response ${t}`)})).catch((e=>{l("Failed response")}))})).catch((()=>l("Failed to fetch id")))}))}async createItem(e){const t={doc:e},s={method:"POST",headers:new Headers({"Content-Type":"application/json"}),credentials:"include",body:JSON.stringify(t)};return new Promise(((e,t)=>{fetch(this.baseUrl,s).then((s=>{Promise.all([s.text(),s.status]).then((([s,l])=>{200===l?e("Success"):t(`Failed with response ${l}`)})).catch((e=>{console.error(`ERROR LEVEL 2: ${e}`),t("Failed response")}))})).catch((e=>{console.error(`ERROR LEVEL 1: ${e}`),t("Failed response.")}))}))}async createFileItem(e,t){const s=new FormData;s.append("file",e),s.append("doc",JSON.stringify(t));const l={method:"POST",credentials:"include",body:s};return new Promise(((e,t)=>{fetch(this.baseUrl,l).then((s=>{Promise.all([s.text(),s.status]).then((([s,l])=>{200===l?e("Success"):t(`Failed with response ${l}`)})).catch((e=>{console.error(`ERROR LEVEL 2: ${e}`),t("Failed response")}))})).catch((e=>{console.error(`ERROR LEVEL 1: ${e}`),t("Failed response.")}))}))}async updateFileItemObject(e,t){const s=new FormData;s.append("file",e),s.append("doc",JSON.stringify(t));const l={method:"PUT",body:s,credentials:"include"};return new Promise(((e,s)=>{fetch(`${this.baseUrl}/${t.id}`,l).then((t=>{Promise.all([t.text(),t.status]).then((([t,l])=>{200===l?e("Success"):s(`Failed with response ${l}`)})).catch((e=>{console.error(`ERROR LEVEL 2: ${e}`),s("Failed response")}))})).catch((e=>{console.error(`ERROR LEVEL 1: ${e}`),s("Failed response.")}))}))}async updateItem(e){const t={doc:e},s={method:"PUT",headers:new Headers({"Content-Type":"application/json"}),credentials:"include",body:JSON.stringify(t)};return new Promise(((t,l)=>{fetch(`${this.baseUrl}/${e.id}`,s).then((e=>{Promise.all([e.text(),e.status]).then((([e,s])=>{200===s?t("Success"):(console.error(`ERROR LEVEL 2: ${e}`),l(`Failed with response ${s}`))})).catch((e=>{console.error(`ERROR LEVEL 2: ${e}`),l("Failed response")}))})).catch((e=>{console.error(`ERROR LEVEL 1: ${e}`),l("Failed response.")}))}))}async updateItemStatus(e){return new Promise(((t,s)=>{fetch(`${this.baseUrl}/set-active/${e}`,{method:"PUT",credentials:"include"}).then((e=>{Promise.all([e.json(),e.status]).then((([e,l])=>{200===l?t("Success"):s(`Failed with response ${l}`)})).catch((e=>{s("Failed response")}))})).catch((e=>{s("Failed")}))}))}async deleteItem(e){return new Promise(((t,s)=>{fetch(`${this.baseUrl}/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{Promise.all([e.text(),e.status]).then((([e,l])=>{200===l?t("Success"):s(`Failed with response ${l}`)})).catch((e=>{s("Failed response")}))})).catch((e=>{s("Failed to delete text")}))}))}}},"./app/model/base-models/misc-file-model.js":(e,t,s)=>{s.r(t),s.d(t,{MiscFileModel:()=>i});var l=s("./app/model/base-models/base-model.js");class i{constructor(){this.baseModel=new l.BaseModel("https://api.ngacho.com/database/miscalleneous-files")}async fetchMiscFiles(){return this.baseModel.getList()}async fetchMiscFileById(e,t=!1){return this.baseModel.getListItemById(e,t)}async deleteMiscFile(e){return this.baseModel.deleteItem(e)}async publishFile(e,t){return this.baseModel.createFileItem(e,t)}}},"./app/model/misc-file-list-model.js":(e,t,s)=>{s.r(t),s.d(t,{MiscFileListModel:()=>i});var l=s("./app/model/base-models/misc-file-model.js");class i extends l.MiscFileModel{constructor(){super()}getMiscFilesFromDb(){return this.fetchMiscFiles()}getMiscFilesFromDbById(e){return this.fetchMiscFileById(e)}deleteMiscFileFromDb(e){return this.deleteMiscFile(e)}}},"./app/view/admin/misc-files/misc-file-list-view.js":(e,t,s)=>{s.r(t),s.d(t,{MiscFileListView:()=>l});class l{constructor(){this.miscFileGallery=document.querySelector(".files-gallery")}renderMiscFiles(e){for(const d of e){const e=d.id,h=d.title,m="image/jpeg"===d.type?d.publicUrl:"https://www.freeiconspng.com/uploads/document-icon-14.png";var t=document.createElement("div");t.id=e,t.className="file-gallery-item",t.tabIndex=0;var s=document.createElement("figure"),l=document.createElement("img");l.className="file-gallery-image",l.src=m,l.alt=`${h} file`,s.appendChild(l);let p=document.createElement("p");p.className="file-gallery-item-text";let u=document.createTextNode(h);p.appendChild(u);var i=document.createElement("div");i.className="file-gallery-item-actions";var a=document.createElement("ul"),c=document.createElement("li");c.className="file-gallery-item-copy";var o=document.createElement("i");o.className=`fas fa-copy ${d.fileCoverTitle}`,o.id=`copy ${e}`,o.ariaHidden=!0,c.appendChild(o);var r=document.createElement("li");r.className="file-gallery-item-delete";var n=document.createElement("i");n.className=`fas fa-trash ${d.fileCoverTitle}`,n.id=`delete ${e}`,n.ariaHidden=!0,r.appendChild(n),a.appendChild(c),a.appendChild(r),i.appendChild(a),t.appendChild(s),t.appendChild(i),t.appendChild(p),this.miscFileGallery.appendChild(t)}}bindDeleteFile(e){this.miscFileGallery.addEventListener("click",(t=>{if(t.target&&"I"==t.target.nodeName&&t.target.className.includes("fas fa-trash")){const s=t.target.id.replace("delete ","");e(s).then((e=>{const t=document.getElementById(s);t.classList.toggle("hide"),setTimeout((()=>{t.remove()}),1500),console.log("deleted successfully")})).catch((e=>{console.log("Failed to delete"),console.log(e)}))}}))}bindCopyFileUrl(e){this.miscFileGallery.addEventListener("click",(t=>{if(t.target&&"I"==t.target.nodeName&&t.target.className.includes("fas fa-copy ")){const s=t.target.id.replace("copy ","");console.log(`copying ${s}`),e(s).then((e=>{console.log(e.publicUrl)})).catch((e=>{console.log(e)}))}}))}}}},t={};function s(l){var i=t[l];if(void 0!==i)return i.exports;var a=t[l]={exports:{}};return e[l](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var l in t)s.o(t,l)&&!s.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};(()=>{s.r(l);var e=s("./app/controller/misc-file-list-controller.js"),t=s("./app/model/misc-file-list-model.js"),i=s("./app/view/admin/misc-files/misc-file-list-view.js");new e.MiscFileListController(new i.MiscFileListView,new t.MiscFileListModel)})()})();
//# sourceMappingURL=miscFilesListAdmin.js.map